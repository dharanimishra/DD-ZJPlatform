<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ziksana.persistence.assessment.TestQuestionMapper">
	<resultMap id="BaseResultMap" type="com.ziksana.domain.assessment.TestQuestion">
		<id column="TestQuestionId" jdbcType="INTEGER" property="testQuestionId" />
		<result column="CreationDate" jdbcType="TIMESTAMP" property="creationDate" />
		<result column="Active" jdbcType="BIT" property="active" />
		<result column="PointsIfCorrect" jdbcType="INTEGER" property="pointsIfCorrect" />
		<result column="ExtraCreditPoints" jdbcType="INTEGER" property="extraCreditPoints" />
		<result column="PenaltyIfIncorrectIndicator" jdbcType="BIT"
			property="penaltyIfIncorrectIndicator" />
		<result column="PenaltyFactor" jdbcType="INTEGER" property="penaltyFactor" />
		<result column="AnswerWithinTime" jdbcType="INTEGER" property="answerWithinTime" />
		<result column="QuestionContentMarkup" jdbcType="VARCHAR"
			property="questionContentMarkup" />
		<result column="VideoAnswerAllowedIndicator" jdbcType="BIT"
			property="videoAnswerAllowedIndicator" />
		<result column="AudioAnwerAllowedIndicator" jdbcType="BIT"
			property="audioAnwerAllowedIndicator" />
		<result column="AssignmentTestId" jdbcType="INTEGER" property="assignmentTestId" />
		<result column="QuestionBankId" jdbcType="INTEGER" property="questionBankId" />
	</resultMap>
	<sql id="Base_Column_List">
		TestQuestionId, CreationDate, Active, PointsIfCorrect,
		ExtraCreditPoints,
		PenaltyIfIncorrectIndicator,
		PenaltyFactor,
		AnswerWithinTime, QuestionContentMarkup, VideoAnswerAllowedIndicator,
		AudioAnwerAllowedIndicator, AssignmentTestId, QuestionBankId
	</sql>

	<insert id="saveTestQuestion" parameterType="com.ziksana.domain.assessment.TestQuestion"
		useGeneratedKeys="true" keyProperty="testQuestionId" keyColumn="testquestionid">
		insert into asmtestquestion
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="creationdate != null">
				creationdate,
			</if>
			<if test="active != null">
				active,
			</if>
			<if test="pointsifcorrect != null">
				pointsifcorrect,
			</if>
			<if test="extracreditpoints != null">
				extracreditpoints,
			</if>
			<if test="penaltyifincorrectindicator != null">
				penaltyifincorrectindicator,
			</if>
			<if test="penaltyfactor != null">
				penaltyfactor,
			</if>
			<if test="answerwithintime != null">
				answerwithintime,
			</if>
			<if test="questionContentMarkup != null">
				questioncontentmarkup,
			</if>
			<if test="videoanswerallowedindicator != null">
				videoanswerallowedindicator,
			</if>
			<if test="audioanwerallowedindicator != null">
				audioanwerallowedindicator,
			</if>
			<if test="testid != null">
				testid,
			</if>
			<if test="questionbankid != null">
				questionbankid,
			</if>
		</trim>
		<trim prefix=" values (" suffix=")" suffixOverrides=",">
			sysdate(),
			<if test="active != null">
				#{active, jdbcType=BOOLEAN},
			</if>
			<if test="pointsIfCorrect != null">
				#{pointsIfCorrect,jdbcType=INTEGER},
			</if>
			<if test="extraCreditPoints != null">
				#{extraCreditPoints,jdbcType=INTEGER},
			</if>
			<if test="isPenaltyIfIncorrect != null">
				#{isPenaltyIfIncorrect,jdbcType=BIT},
			</if>
			<if test="penaltyMarks != null">
				#{penaltyMarks,jdbcType=INTEGER},
			</if>
			<if test="answerWithinTime != null">
				#{answerWithinTime,jdbcType=INTEGER},
			</if>
			<if test="questionContentMarkup != null">
				#{questionContentMarkup,jdbcType=VARCHAR},
			</if>
			<if test="isVideoAnswerAllowed != null">
				#{isVideoAnswerAllowed,jdbcType=BIT},
			</if>
			<if test="isAudioAnwerAllowed != null">
				#{isAudioAnwerAllowed,jdbcType=BIT},
			</if>
			<if test="test != null">
				#{test.testId,jdbcType=INTEGER},
			</if>
			<if test="questionBank != null">
				#{questionBank.questionBankId, jdbcType=INTEGER},
			</if>
		</trim>
		<selectKey keyProperty="testQuestionId" resultType="int"
			order="AFTER">
			SELECT LAST_INSERT_ID();
		</selectKey>
	</insert>


	<update id="updateTestQuestion" parameterType="com.ziksana.domain.assessment.TestQuestion">
		update asmtestquestion
		<set>
			<if test="pointsIfCorrect != null">
				pointsIfCorrect = #{pointsIfCorrect,jdbcType=INTEGER},
			</if>
			<if test="extraCreditPoints != null">
				extraCreditPoints =
				#{extraCreditPoints,jdbcType=INTEGER},
			</if>
			<if test="isPenaltyIfIncorrect != null">
				penaltyifincorrectindicator =
				#{isPenaltyIfIncorrect,jdbcType=BIT},
			</if>
			<if test="penaltyMarks != null">
				penaltyfactor = #{penaltyMarks,jdbcType=INTEGER},
			</if>
			<if test="answerWithinTime != null">
				answerWithinTime = #{answerWithinTime,jdbcType=INTEGER},
			</if>
			<if test="questionContentMarkup != null">
				questionContentMarkup =
				#{questionContentMarkup,jdbcType=VARCHAR},
			</if>
			<if test="isVideoAnswerAllowed != null">
				videoanswerallowedindicator =
				#{isVideoAnswerAllowed,jdbcType=BIT},
			</if>
			<if test="isAudioAnwerAllowed != null">
				audioanwerallowedindicator =
				#{isAudioAnwerAllowed,jdbcType=BIT},
			</if>
			<if test="test != null">
				testId = #{test.testId,jdbcType=INTEGER},
			</if>
			<if test="questionBank != null">
				questionBankId = #{questionBank.questionBankId,
				jdbcType=INTEGER},
			</if>
		</set>
		where testquestionid = #{testQuestionId,jdbcType=INTEGER}
	</update>

	<insert id="saveQuestionBank" parameterType="com.ziksana.domain.assessment.QuestionBank"
		useGeneratedKeys="true" keyProperty="questionBankId" keyColumn="questionbankid">
		insert into asmquestionbank
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="creationdate != null">
				creationdate,
			</if>
			<if test="active != null">
				active,
			</if>
			<if test="difficultylevel != null">
				difficultylevel,
			</if>
			<if test="proficiencylevel != null">
				proficiencylevel,
			</if>
			<if test="questiontype != null">
				questioncontent,
			</if>
			<if test="additionalinfopath != null">
				additionalinfopath,
			</if>
			<if test="instruction != null">
				instruction,
			</if>
			<if test="questionContentMarkup != null">
				questioncontentmarkup,
			</if>
			<if test="multiplecorrectanswerindicator != null">
				multiplecorrectanswerindicator,
			</if>
			<if test="groupworkindicator != null">
				groupworkindicator,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="questionapplicabilitytype != null">
				questionapplicabilitytype,
			</if>
			<if test="memberid != null">
				memberid,
			</if>
			<if test="subjclassificationid != null">
				subjclassificationid,
			</if>
		</trim>		"insert into asmquestionbank set  profficiencylevel=, ",
			"questiontype=#{questionType, jdbcType=INTEGER}, ",
			"questioncontent=#{name, jdbcType=VARCHAR}, instruction=,",
			" ismulticorrectanswer=, additionalinfopath=#{additionalInfoPath, jdbcType=VARCHAR} ,",
			"isgroupwork= , questionapplicabilitytype=#{questionApplicabilityType, jdbcType=INTEGER} ",
			" where questionbankid=#{questionBankId, jdbcType=INTEGER}" })
		
		<trim prefix=" values (" suffix=")" suffixOverrides=",">
			sysdate(),
			<if test="active != null">
				#{active, jdbcType=BOOLEAN},
			</if>
			<if test="difficultyLevel != null">
				#{difficultyLevelId , jdbcType=INTEGER},
			</if>
			<if test="proficiencylevel != null">
				#{proficiencyLevelId, jdbcType=INTEGER},
			</if>
			<if test="questionText != null">
				#{questionText, jdbcType=VARCHAR},
			</if>
			<if test="additionalInfoPath != null">
				#{additionalinfopath, jdbcType=VARCHAR},
			</if>
			<if test="instruction != null">
				#{instruction, jdbcType=VARCHAR},
			</if>
			<if test="questionContentMarkup != null">
				#{questionContentMarkup,jdbcType=VARCHAR},
			</if>
			<if test="isMultiCorrectAnswer != null">
				#{isMultiCorrectAnswer,jdbcType=BOOLEAN},
			</if>
			<if test="isGroupWork != null">
				#{isGroupWork,jdbcType=BOOLEAN},
			</if>
			<if test="status != null">
				#{statusId,jdbcType=BOOLEAN},
			</if>
			<if test="questionApplicabilityType != null">
				#{questionApplicabilityTypeId, jdbcType=INTEGER},
			</if>
			<if test="owningMember != null">
				#{owningMember.memberId, jdbcType=INTEGER},
			</if>
			<if test="subjClassification != null">
				#{subjClassification.subjClassificationId, jdbcType=INTEGER},
			</if>
		</trim>
		<selectKey keyProperty="questionBankId" resultType="int"
			order="AFTER">
			SELECT LAST_INSERT_ID();
		</selectKey>
	</insert>

	<update id="updateQuestionBank" parameterType="com.ziksana.domain.assessment.QuestionBank">
		update asmquestionbank
		<set>
			<if test="difficultyLevel != null">
				difficultyLevel = #{difficultyLevelId , jdbcType=INTEGER},
			</if>
			<if test="proficiencyLevel != null">
				proficiencyLevel = #{proficiencyLevelId, jdbcType=INTEGER},
			</if>
			<if test="questionText != null">
				questionText = #{questionText, jdbcType=VARCHAR},
			</if>
			<if test="additionalInfoPath != null">
				additionalInfoPath = #{additionalinfopath, jdbcType=VARCHAR},
			</if>
			<if test="instruction != null">
				instruction = #{instruction, jdbcType=VARCHAR},
			</if>
			<if test="questionContentMarkup != null">
				questionContentMarkup = #{questionContentMarkup,jdbcType=VARCHAR},
			</if>
			<if test="isMultiCorrectAnswer != null">
				isMultiCorrectAnswer = #{isMultiCorrectAnswer,jdbcType=BOOLEAN},
			</if>
			<if test="isGroupWork != null">
				isGroupWork = #{isGroupWork,jdbcType=BOOLEAN},
			</if>
			<if test="questionApplicabilityType != null">
				questionApplicabilityType = #{questionApplicabilityTypeId, jdbcType=INTEGER},
			</if>
		</set>
		where questionbankId = #{questionBankId, jdbcType="INTEGER"}
	</update>

</mapper>