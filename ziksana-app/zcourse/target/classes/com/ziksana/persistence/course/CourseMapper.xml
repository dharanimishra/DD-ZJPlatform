<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ziksana.persistence.course.CourseMapper">
	<resultMap id="BaseResultMap" type="com.ziksana.domain.course.Course">
		<id column="CourseId" property="courseId" jdbcType="INTEGER" />
		<result column="Name" property="name" jdbcType="VARCHAR" />
		<result column="CourseIdentifier" property="courseIdentifier"
			jdbcType="VARCHAR" />
		<result column="Description" property="description" jdbcType="VARCHAR" />
		<result column="ValidFrom" property="ValidFrom" jdbcType="DATE" />
		<result column="ValidTo" property="ValidTo" jdbcType="DATE" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="Rating" property="rating" jdbcType="INTEGER" />
		<result column="ContentSecurityNeededIndicator" property="contentSecurityNeededIndicator"
			jdbcType="BIT" />
		<result column="TotalCredits" property="totalCredits" jdbcType="VARCHAR" />
		<result column="ExtraCreditsIndicator" property="extraCreditsIndicator"
			jdbcType="BIT" />
		<result column="ExtraCredits" property="extraCredits" jdbcType="VARCHAR" />
		<result column="AdditionalPropertyIndicator" property="additionalPropertyIndicator"
			jdbcType="BIT" />
		<result column="CourseDuration" property="courseDuration"
			jdbcType="INTEGER" />
		<result column="ThumbnailPicturePath" property="thumbnailPicturePath"
			jdbcType="VARCHAR" />
		<result column="TemplateIndicator" property="templateIndicator"
			jdbcType="TINYINT" />
		<result column="Version" property="version" jdbcType="INTEGER" />
		<result column="MemberRoleId" property="memberRoleId" jdbcType="INTEGER" />
		<result column="SubjClassificationId" property="subjClassificationId"
			jdbcType="INTEGER" />
	</resultMap>
	<sql id="Base_Column_List">
		CourseId, Name, CourseIdentifier, Description, ValidFrom,
		ValidTo, CourseStatus, Rating,
		ContentSecurityNeededIndicator,
		CourseWeightage, TotalCredits, ExtraCreditsIndicator,
		ExtraCredits,AdditionalPropertyIndicator, CourseDuration,
		ThumbnailPicturePath, TemplateIndicator, Version, MemberRoleId,
		SubjClassificationId
	</sql>

	<insert id="insertSelective" parameterType="com.ziksana.domain.course.Course"
		useGeneratedKeys="true" keyProperty="ID">
		insert into corcourse
		<trim prefix="(" suffix=")" suffixOverrides=",">
			CourseId,
			<if test="name != null">
				Name,
			</if>
			<if test="courseIdentifier != null">
				CourseIdentifier,
			</if>
			<if test="description != null">
				Description,
			</if>
			<if test="ValidFrom != null">
				ValidFrom,
			</if>
			<if test="ValidTo != null">
				ValidTo,
			</if>
			<if test="courseStatus != null">
				CourseStatus,
			</if>
			<if test="rating != null">
				Rating,
			</if>
			<if test="contentSecurityNeededIndicator != null">
				ContentSecurityNeededIndicator,
			</if>
			<if test="courseWeightage != null">
				CourseWeightage,
			</if>
			<if test="totalCredits != null">
				TotalCredits,
			</if>
			<if test="extraCreditsIndicator != null">
				ExtraCreditsIndicator,
			</if>
			<if test="extraCredits != null">
				ExtraCredits,
			</if>
			<if test="additionalPropertyIndicator != null">
				AdditionalPropertyIndicator,
			</if>
			<if test="courseDuration != null">
				CourseDuration,
			</if>
			<if test="thumbnailPicturePath != null">
				ThumbnailPicturePath,
			</if>
			<if test="templateIndicator != null">
				TemplateIndicator,
			</if>
			<if test="version != null">
				Version,
			</if>
			<if test="memberRoleId != null">
				MemberRoleId,
			</if>
			<if test="subjClassificationId != null">
				SubjClassificationId,
			</if>

		</trim>

		<trim prefix="values (" suffix=")" suffixOverrides=",">
			#{courseId,jdbcType=INTEGER},
			<if test="name != null">
				#{name,jdbcType=VARCHAR},
			</if>
			<if test="courseIdentifier != null">
				#{courseIdentifier,jdbcType=VARCHAR},
			</if>
			<if test="description != null">
				#{description,jdbcType=VARCHAR},
			</if>
			<if test="ValidFrom != null">
				#{ValidFrom,jdbcType=DATE},
			</if>
			<if test="ValidTo != null">
				#{ValidTo,jdbcType=DATE},
			</if>
			<if test="courseStatus != null">
				#{courseStatus,jdbcType=INTEGER},
			</if>
			<if test="rating != null">
				#{rating,jdbcType=INTEGER},
			</if>
			<if test="contentSecurityNeededIndicator != null">
				#{contentSecurityNeededIndicator,jdbcType=BIT},
			</if>
			<if test="courseWeightage != null">
				#{courseWeightage,jdbcType=INTEGER},
			</if>
			<if test="totalCredits != null">
				#{totalCredits,jdbcType=VARCHAR},
			</if>
			<if test="extraCreditsIndicator != null">
				#{extraCreditsIndicator,jdbcType=BIT},
			</if>
			<if test="extraCredits != null">
				#{extraCredits,jdbcType=VARCHAR},
			</if>
			<if test="additionalPropertyIndicator != null">
				#{additionalPropertyIndicator,jdbcType=BIT},
			</if>
			<if test="courseDuration != null">
				#{courseDuration,jdbcType=INTEGER},
			</if>
			<if test="thumbnailPicturePath != null">
				#{thumbnailPicturePath,jdbcType=VARCHAR},
			</if>
			<if test="templateIndicator != null">
				#{templateIndicator,jdbcType=TINYINT},
			</if>
			<if test="version != null">
				#{version,jdbcType=INTEGER},
			</if>
			<if test="memberRoleId != null">
				#{memberRoleId,jdbcType=INTEGER},
			</if>
			<if test="subjClassificationId != null">
				#{subjClassificationId,jdbcType=INTEGER},
			</if>

		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.ziksana.domain.course.Course">
		update corcourse
		<set>
			<if test="name != null">
				Name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="courseIdentifier != null">
				CourseIdentifier = #{courseIdentifier,jdbcType=VARCHAR},
			</if>
			<if test="description != null">
				Description = #{description,jdbcType=VARCHAR},
			</if>
			<if test="ValidFrom != null">
				ValidFrom = #{ValidFrom,jdbcType=DATE},
			</if>
			<if test="ValidTo != null">
				ValidTo = #{ValidTo,jdbcType=DATE},
			</if>
			<if test="courseStatus != null">
				CourseStatus = #{courseStatus,jdbcType=INTEGER},
			</if>
			<if test="rating != null">
				Rating = #{rating,jdbcType=INTEGER},
			</if>
			<if test="contentSecurityNeededIndicator != null">
				ContentSecurityNeededIndicator =
				#{contentSecurityNeededIndicator,jdbcType=BIT},
			</if>
			<if test="courseWeightage != null">
				CourseWeightage = #{courseWeightage,jdbcType=INTEGER},
			</if>
			<if test="totalCredits != null">
				TotalCredits = #{totalCredits,jdbcType=VARCHAR},
			</if>
			<if test="extraCreditsIndicator != null">
				ExtraCreditsIndicator =
				#{extraCreditsIndicator,jdbcType=BIT},
			</if>
			<if test="extraCredits != null">
				ExtraCredits = #{extraCredits,jdbcType=VARCHAR},
			</if>
			<if test="additionalPropertyIndicator != null">
				AdditionalPropertyIndicator =
				#{additionalPropertyIndicator,jdbcType=BIT},
			</if>
			<if test="courseDuration != null">
				CourseDuration=#{courseDuration,jdbcType=INTEGER},
			</if>
			<if test="thumbnailPicturePath != null">
				ThumbnailPicturePath=#{thumbnailPicturePath,jdbcType=VARCHAR},
			</if>
			<if test="templateIndicator != null">
				TemplateIndicator=#{templateIndicator,jdbcType=TINYINT},
			</if>
			<if test="version != null">
				Version = #{version,jdbcType=INTEGER},
			</if>
			<if test="memberRoleId != null">
				MemberRoleId = #{memberRoleId,jdbcType=INTEGER},
			</if>
			<if test="subjClassificationId != null">
				SubjClassificationId =
				#{subjClassificationId,jdbcType=INTEGER},
			</if>
		</set>
		where CourseId = #{courseId,jdbcType=INTEGER}
	</update>

<!-- 	<resultMap id="courseCatalogMap" type="com.ziksana.domain.course.Course">
		<id column="CourseId" property="CourseId" jdbcType="INTEGER" />
		<result column="Name" property="name" jdbcType="VARCHAR" />
		<result column="CourseIdentifier" property="courseIdentifier"
			jdbcType="VARCHAR" />
		<result column="Description" property="description" jdbcType="VARCHAR" />
		<result column="ValidFrom" property="ValidFrom" jdbcType="DATE" />
		<result column="ValidTo" property="ValidTo" jdbcType="DATE" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="Rating" property="rating" jdbcType="INTEGER" />
		<result column="MemberRoleId" property="memberRoleId" jdbcType="INTEGER" />
		<association property="CoursePlaybook" column="ID"
			javaType="com.ziksana.domain.course.CoursePlaybook" select="pbookMap">
		</association>
		<collection property="CourseComponents" javaType="ArrayList"
			column="ID" ofType="com.ziksana.domain.course.CourseComponent"
			resultMap="courseComponentMap">
			<association property="corPlaybookComponetContents"
				column="ID" javaType="com.ziksana.domain.course.CorPlaybookComponentContent"
				select="courseComponentContentMap">
			</association>
		</collection>
	</resultMap>

	<resultMap type="com.ziksana.domain.course.CoursePlaybook"
		id="pbookMap">
		<id column="ID" property="ID" jdbcType="INTEGER" />
		<result column="StartDate" property="startDate" jdbcType="DATE" />
		<result column="EndDate" property="endDate" jdbcType="DATE" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="CourseID" property="courseID" jdbcType="INTEGER" />
	</resultMap>

	<resultMap type="com.ziksana.domain.course.CourseComponent"
		id="courseComponentMap">
		<id column="ID" property="ID" jdbcType="INTEGER" />
		<result column="StartDate" property="startDate" jdbcType="DATE" />
		<result column="EndDate" property="endDate" jdbcType="DATE" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="Weightage" property="weightage" jdbcType="INTEGER" />
		<result column="TotalCredits" property="totalCredits" jdbcType="VARCHAR" />
		<result column="ExtraCreditsIndicator" property="extraCreditsIndicator"
			jdbcType="BIT" />
		<result column="ExtraCredits" property="extraCredits" jdbcType="VARCHAR" />
		<result column="CourseId" property="courseId" jdbcType="INTEGER" />
		<result column="MemberRoleId" property="memberRoleId" jdbcType="INTEGER" />
		<result column="CourseComponentTypeId" property="courseComponentTypeId"
			jdbcType="INTEGER" />
	</resultMap>


	<resultMap type="com.ziksana.domain.course.CourseComponentContent"
		id="courseComponentContentMap">
		<id column="ID" property="ID" jdbcType="INTEGER" />
		<result column="CreationDate" property="creationDate" jdbcType="TIMESTAMP" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="ContentType" property="contentType" jdbcType="INTEGER" />
		<result column="ContentDescription" property="contentDescription"
			jdbcType="VARCHAR" />
		<result column="Active" property="active" jdbcType="BIT" />
		<result column="ContentVersionUsed" property="contentVersionUsed"
			jdbcType="INTEGER" />
		<result column="CourseComponentId" property="courseComponentId"
			jdbcType="INTEGER" />
		<result column="VideoSynchronizeID" property="videoSynchronizeID"
			jdbcType="INTEGER" />
		<result column="ContentID" property="contentID" jdbcType="INTEGER" />
	</resultMap>

	<select id="getCourseCatalog" resultMap="courseCatalogMap"
		parameterType="int">
		select CourseId, Name, CourseIdentifier, Description,
		ValidFrom, ValidTo, CourseStatus, Rating,
		ContentSecurityNeededIndicator,
		CourseWeightage, TotalCredits,
		ExtraCreditsIndicator, ExtraCredits,
		AdditionalPropertyIndicator,
		MemberRoleId, Version FROM CorCourse where
		CourseId=#{courseId}
	</select>

	<select id="pbookMap" parameterType="int" resultType="com.ziksana.domain.course.CoursePlaybook"> 
		SELECT ID, StartDate, EndDate, CoursePlaybookStatus, CoursePlaybookType, 
		CourseID FROM CorCoursePlaybook WHERE CourseID = #{ID} </select>
 -->
	<!-- Below is the one one query to retrieve the entire catalog <select id="getCourseCatalog" 
		resultMap="courseCatalogMap"> select * from ziksanadb.CorCourse cc, ziksanadb.CorCoursePlaybook 
		pb, ziksanadb.CorPlaybookComponent pbc, ziksanadb.CorPlaybookComponentContent 
		pbcc where pbcc.PlaybookComponentId=pbc.id and pbc.playbookid=pb.id and cc.id 
		= pb.courseid </select> -->


	<resultMap id="CourseTreeMap" type="com.ziksana.domain.course.Course">
		<id column="CourseId" property="courseid" jdbcType="INTEGER" />
		<result column="Name" property="name" jdbcType="VARCHAR" />
		<result column="CourseIdentifier" property="courseIdentifier"
			jdbcType="VARCHAR" />
		<result column="Description" property="description" jdbcType="VARCHAR" />
		<result column="ValidFrom" property="ValidFrom" jdbcType="DATE" />
		<result column="ValidTo" property="ValidTo" jdbcType="DATE" />
		<result column="CourseStatus" property="courseStatus" jdbcType="INTEGER" />
		<result column="Rating" property="rating" jdbcType="INTEGER" />
		<result column="MemberRoleId" property="memberRoleId" jdbcType="INTEGER" />
		<collection property="learningComponents" javaType="ArrayList"
			column="courseid" ofType="com.ziksana.domain.course.LearningComponent"
			resultMap="learningComponentMap">
			<collection property="learningCompContentList" javaType="ArrayList"
				column="leqarningcomponentid" ofType="com.ziksana.domain.course.LearningComponentContent"
				resultMap="learningComponentContentMap">
				<association property="learningComponents"
					column="learningcomponentcontentid" javaType="com.ziksana.domain.course.LearningContent"
					select="learningContentMap">
					<collection property="learningContentParts" javaType="ArrayList"
							column="learningcontentid" ofType="com.ziksana.domain.course.LearningContentParts"
							resultMap="learningContentPartsMap">
					</collection>
				</association>
			</collection>
		</collection>
	</resultMap>

	<select id="learningComponentMap" parameterType="Integer"
		resultType="com.ziksana.domain.course.LearningComponent">
		SELECT
		ID, StartDate, EndDate, CourseStatus, Weightage,
		TotalCredits,
		ExtraCreditsIndicator, ExtraCredits, CourseId,
		MemberRoleId,
		CourseComponentTypeId FROM CorcourseComponent
		WHERE
		CourseId = #{courseid}
	</select>

	<select id="learningComponentContentMap" parameterType="Integer"
		resultType="com.ziksana.domain.course.LearningComponentContent">
		SELECT
		ID, CreationDate, CourseStatus, ContentType,
		ContentDescription, Active,
		ContentVersionUsed, CourseComponentId,
		VideoSynchronizeID, ContentID
		FROM CorlearningComponentContent
		WHERE
		learningComponentId = #{learningComponentId}
	</select>


</mapper>